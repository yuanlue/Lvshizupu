<!DOCTYPE html>
  <html>
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
      <title>title</title>
      <style>
      body{
        background: #eee;
        padding:0;
        margin: 0;
    }
    h1{
      margin:0;
    }
    .marketUser{
		min-height: 100vh;
	}
	.marketUser .banner>.info>.avata{
		height:50px;
		border-radius: 50%;
		text-align: center;
		vertical-align: middle;
		display: inline-block;
		overflow: hidden;
		width:50px;
	}
	.marketUser .banner>.info>.avata img{
			width:100%;
	}
	.marketUser .banner>.info>.userinfo h1{
		color:white;
		font-size:16px;
	}
	.marketUser .banner>.info>.userinfo h1+span{
		color:#d2bb81;
	}
	.marketUser .banner>.info>.userinfo h1+span button{
		background-color: transparent;
    color:#d2bb81;
		border:1px solid #d2bb81;
		padding:2px 5px;
		border-radius:10px;
	}
	.marketUser .banner>.info>.userinfo{
		vertical-align: middle;
		display: inline-block;
	}
	.marketUser .banner{
	  position: relative;
  box-sizing: border-box;
		display: flex;
		justify-content:space-between;
		padding:35px 10px 0;
		width:100%;
		background:#9e2931;
		background-size: cover;
	}
	.marketUser .banner i img{
		width:55px;
	}
	.marketUser .banner i{
		display: inline-block;
	}
    .banner{
      width:100%;
      background: url('../../image/market/userb.jpg') no-repeat;
      background-size: cover;
    }
    .usercenter header{
      padding:0 10px;
      border-bottom:1px solid #eee;
      line-height: 90px;
    }
    .usercenter header img{
      width:50px;
      vertical-align: middle;
    }
    ul{
      margin:0;
      padding:0 10px;
      list-style: none;
    }
    .usercenter ul>li {
      font-size:14px;
      line-height: 50px;
    }
      .usercenter>ul{
        background: white;
        margin-top:10px;
      }
      .usercenter>ul>li{
        border-bottom:1px solid #eee;
      }
    .usercenter ul>li img{

      width:25px;
      vertical-align: middle;
    }
    .cancel{
      height:100vh;
      display: inline-block;
      width:18%;
    }
    ol{
      border-top:1px solid #eee;
      padding-top:10px;
      border-bottom:1px solid #eee;
      display: table;
      margin:0;
      width:100%;
      padding-left:0;
      list-style: none;
    }
    ol li{
      position: relative;
      vertical-align: bottom;
      display: table-cell;
      line-height: 1;
      text-align: center;
    }
      .usercenter ul>li>ol>li p{
        font-size:11px;
        color:#666;
      }
    .usercenter ul>li>ol>li img{
      margin-right:0;
      width:20px;
    }
    .usercenter ul>li>ol>li span{
      position: absolute;
      right:20px;;
      top:-5px;
      background: #9e2831;
      border-radius: 50%;
      width:20px;
      height:20px;
      line-height: 20px;
      color:white;
      font-size:10px;
    }
    *:focus{
      outline: none;
    }
    ul>li:active{
      background: #eee;
    }
      .marketUser .return{
        width:12px;
      }
    .marketUser .banner>.title{
      text-align: left;
      top:30px;
      display: inline-block;
      left:10px;
      color:white;
      font-size:16px;
      position: absolute;
    }
    .marketUser .banner .info b{
      font-weight: normal;
    }
    i img{
      display: none;
    }
    i #jiangpai1{
      display: inline-block;
    }
    .tab{
      background: #981d25;
      line-height: 35px;
      font-size:0;
      text-align: center;
    }
    .tab>div{
      display: inline-block;
      width:50%;
      font-size:13px;
      color:white;
    }
    .order .remark{
      color:#999999;
      float: right;
      font-size:12px;
    }
    .market{
      margin-top:10px;
      font-size:14px;
      background: white;
    }
    .market header{
      line-height: 50px;
    }
      .usercenter .market ul{
        font-size:0;
      }
    .usercenter .market ul li{
      padding-top:10px;
      line-height: 1;
      width:25%;
      display: inline-block;
      text-align: center;
    }
      </style>
  </head>
  <body class="marketUser usercenter">

    <div class="banner">

    <div class="info">
      <span class="avata pic">
        <img onclick="changePic()" src="../../image/male.png">
      </span>
      <span class="userinfo">
        <h1></h1>
      <span>积分：<b>0</b>
        <button onclick="rule()">等级规则</button>
      </span>
      </span>

    </div>
    <i>
        <img id="jiangpai6" src="../../image/market/zuanshi.png" alt="">
        <img id="jiangpai5" src="../../image/market/baijin.png" alt="">
        <img id="jiangpai4" src="../../image/market/huangjin.png" alt="">
        <img id="jiangpai3" src="../../image/market/yinpai.png" alt="">
        <img id="jiangpai2" src="../../image/market/tongpai.png" alt="">
        <img id="jiangpai1" src="../../image/market/zhucepai.png" alt="">

      </i>

</div>
<div class="tab">
  <div  onclick="rule()">等级规则</div>
  <div onclick="userInfo()" class="info">账户信息</div>
</div>
      <ul class="order">
        <li onclick="order('myorder','')">我的订单
          <span class="remark">查看更多订单</span>
          <ol>
              <li class="paying"  onclick="order('myorder','paying')">
                <span>1</span>
                <img src="../../image/market/icon-daifukuan.png" alt="">
                <p>待付款</p>
              </li>
              <li class="shipping"  onclick="order('myorder','shipping')">
                <span>1</span>
                <img src="../../image/market/icon-daifahuo.png" alt="">
                <p>待发货</p></li>
              <li class="incoming"  onclick="order('myorder','incoming')">
                <span>1</span>
                <img src="../../image/market/icon-daishouhuo.png" alt="">
                <p>待收货</p></li>
              <li class="commenting"  onclick="order('myorder','commenting')">
                <span>1</span>
                <img src="../../image/market/icon-daipingjia.png" alt="">
                <p>待评价</p></li>

          </ol>
        </li>

      </ul>
      <div class="market">
        <header>商城服务</header>
        <ul>
          <li onclick="order('collection')"><img src="../../image/user_collect.png" alt="">
            <p>我的收藏</p></li>
          <li onclick="order('address')"><img src="../../image/user_address.png" alt="">
          <p>收货地址</p></li>
          <li onclick="order('myfoot')"><img src="../../image/user_foot.png" alt="">
          <p>我的足迹</p></li>
          <li onclick="order('myVoucher')"><img src="../../image/user_kaquan.png" alt=""><p>卡券中心</p></li>
          <li onclick="order('myfoot')"><img src="../../image/user_kaquanbao.png" alt=""><p>卡券包</p></li>
        </ul>
      </div>
      <div class="market">
        <header>宗亲服务</header>
        <ul>
          <li class="invate" onclick="navchange('invitation')"><img src="../../image/user_yaoqing.png" alt="">
            <p>邀请异性宗亲</p></li>
          <li onclick="navchange('join')"><img src="../../image/user_join.png" alt="">
          <p>加入宗亲</p></li>
          <li onclick="navchange('record')"><img src="../../image/user_don.png" alt=""><p>捐款记录</p></li>
          <li onclick="navchange('com')"><img src="../../image/user_entre.png" alt=""><p>企业管理</p></li>
          <li onclick="navchange('advice')"><img src="../../image/user_back.png" alt=""><p>用户反馈</p></li>
          <li onclick="navchange('setting')"><img src="../../image/user_set.png" alt=""><p>设置</p></li>

        </ul>
      </div>
    </div>
  </body>
  <script type="text/javascript" src="../../script/api.js"></script>
  <script type="text/javascript" src="../../script/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="../../script/service.js"></script>

  <script type="text/javascript">
  function re(){
    window.location.reload()
  }
  function userInfo(){
    api.openWin({
        name: 'userInfo',
        url: '../../html/user/userInfo.html',
        bounces:false
    });

  }
  function changePic(){
    api.getPicture({
      sourceType: 'all',
      encodingType: 'jpg',
      mediaValue: 'pic',
      destinationType: 'url',
      allowEdit: true,
      quality: 50,
      targetWidth: 100,
      targetHeight: 100,
      saveToPhotoAlbum: false
  }, function(ret, err) {
      if (ret.data.length>1) {
        api.showProgress({
        title: '努力上传图像...',
        text: '先喝杯茶...',
        modal: false
    });
      changeAvata(ret.data,{'authorization':$api.getStorage('token')},function(data){
        api.hideProgress();

        if(data.code==200){
          obj=$api.dom('.name')
          imgobj=$api.dom('.pic img')
          $api.setStorage('avata', data.data.url);

          $api.attr(imgobj,'src',data.data.url);
        }



      },function(err){
        alert(JSON.stringify(err))

        api.toast({
                msg: '上传失败',
                duration:2000,
                location: 'bottom'
            });
      })

      } else {

      }
  });
  }
  function rule(){
    api.openWin({
        name: 'ruleWin',
        url: '../../html/market/ruleWin.html',
    });

  }
  function cancel(){
    api.closeFrame();
  }
  function cart(){
    api.openWin({
        name: 'cart',
        url: '../../html/market/cartWin.html',

    });
  }
  function opens(){
    getData('/shop/sellers/new',function(data){
      if(data.code==200){
        if(data.data.type!=0){
          api.openWin({
              name: 'status',
              url: '../../html/user/openshop/statusWin.html',
              pageParam:{
                message:data.data.message
              }
          });

          return false
        }
        else{
          api.openWin({
              name: 'shopWin',
              url: '../../html/user/openshop/shopWin.html',
          });
        }
      }
      else{
        api.toast({
                msg: '系统繁忙',
                duration:2000,
                location: 'bottom'
            });
      }
    },{},{'Authorization':$api.getStorage('token')})

  }
  function navchange(url){
    if(url=="join"){
      if($api.getStorage('joined_family')=="true"){
          api.openWin({
              name: 'joinSuccess',
              url: '../../html/user/join/success.html',
          });
              return false;
      }

    }
    api.openWin({
        name: url,
        url: '../../html/user/'+url+'/'+url+'.html',
    });

  }
  function order(name,type){
    if(name=='cart'||name=='myorder'||name=='myVoucher'||name=='myfoot'||name=='collection'||name=='voucherCenter'){
        limitLogin()
        if(!$api.getStorage('token')){
          return
        }
    }
    api.openWin({
        name: name,
        url: '../../html/market/'+name+'Win.html',
        bounces:false,
        pageParam:{
          type:type
        }

    });
  }
  function init(){

    if($api.getStorage('joined_family')=='true'){
      $('.info').show()
      $('.invate').show()
    }
    if($api.getStorage('user_id')){
      api.showProgress({
          style: 'default',
          animationType: 'fade',
          title: '努力加载中...',
          text: '先喝杯茶...',
          modal: false
      });
      getData('/shop/users/profile',res=>{
        api.hideProgress();
        if(res.code==200){
          $('.usercenter .banner i img').hide()
          $(`.usercenter .banner i #jiangpai${res.data.group_id}`).show()
          $('.usercenter .info .userinfo span b').text(res.data.point)
        }
      },{},{'Authorization':$api.getStorage('token')})
      getData('/shop/orders/status',function(data){
        if(data.code==200){
          $('.paying>span').text(data.data.paying)
          $('.shipping>span').text(data.data.shipping)

          $('.incoming>span').text(data.data.incoming)

          $('.commenting>span').text(data.data.commenting)

        }
        else{
          api.toast({
              msg: '网络错误',
              duration: 2000,
              location: 'bottom'
          });

        }
      },{},{'Authorization':$api.getStorage('token')})

    }


    if($api.getStorage('avata')){
      $('.usercenter .info .avata img').attr('src',$api.getStorage('avata'))

    }
    $('.usercenter .info .userinfo h1').html($api.getStorage('mobile'))
  }
      apiready = function(){
        init()
        $('img').bind('error',function(){
          $(this).attr('src','../../image/male.png')
        })

      };
  </script>
  </html>
