<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width"/>
    <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
    <title>Hello APP</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../../css/swiper-3.4.2.min.css"/>

	<style>

  .market{
  	padding-bottom:50px;
  	min-height: 100vh;
  	overflow: hidden;
  	background-color: #f5f4f4;
  }
  .market>.banner{
  	position: relative;
  	height:145px;
  }
  .market>.banner img{
  	width:100%;
  }
  .market .search {
    box-sizing: border-box;
  	line-height:45px;
  	padding:0 10px;
    z-index:9999;
  	position: absolute;
  	width:100%;
  	bottom:-15px;
  }
  .market .search input{
    background: white;
  	text-align: center;
  	font-size:14px;
  	border-radius: 20px;
  	box-shadow: 1px 1px 5px #ccc;
  	width:100%;
  	line-height: 45px;
  }
  .market .menu{
  	background-color: white;
  	margin-top:10px;
  	padding:20px 10px;
  }
  .market .menu ul {
  	font-size:0;
  }
  .market .menu ul li img{
  	width:50px;
  }
  .market .menu ul li{
  	margin-top:10px;
  	text-align: center;
  	display: inline-block;
  	width:25%;
  }
  .market .menu ul li p{
  	margin-top:10px;
  	font-size:14px;
  	text-align: center;
  }
  .market header{
  	height:42px;
  	color:white;
  	line-height: 42px;
  	width:100%;
  	text-align: center;
  		margin-bottom:10px;

  }
  .market header span{
  	font-size:15px;
  }

  .market .visit header{
  	background: url("../../image/guangshangchang.png") no-repeat;
  	background-size: cover;
  }
  .market .visit img{
    width:100%;
  }
  .market .recom{
  	margin-top:10px;
  }
  .market .recom header{
  		background: url("../../image/tuijian.png") no-repeat;
  	background-size: cover;
  }
  .market .limTime header{
  		background: url("../../image/xianshi.jpg") no-repeat;
  	background-size: cover;
  }
  .market .like header{
  	margin-top:.26666667rem/* 20px */;
  		background: url("../../image/cainixihuan.png") no-repeat;
  	background-size: cover;
  }
  .market .visit ul{
  	border-bottom:1px solid #efebeb;
  	font-size:0;
  }
  .market .visit ul>li{
  	overflow: hidden;
  	background:white;
  	border-right:1px solid #efebeb;
  	height: 110px;
  	display: inline-block;
  	box-sizing: border-box;
  	width:50%;
  	  border-collapse:collapse;

  	font-weight: bold;
  	font-size:16px;
  }
  .market .visit ol{
  	border-bottom:1px solid #efebeb;
  	font-size:0;
  }
  .market .visit ol>li{
      vertical-align: top;
  	overflow: hidden;
  	background:white;
  	  border-collapse:collapse;
  	border-right:1px solid #efebeb;
  	height: 150px;
  	display: inline-block;
  	box-sizing: border-box;
  	width:25%;
  	font-weight: bold;
  	font-size:16px;
  }
  .market .visit ul>li img{
  }
  .market .recom ul{
  	width:100%;
  	white-space:nowrap;
  	height:180px;
  	overflow: auto;
  }
  .market .recom ul li{
  	line-height: 1.5;
    margin-left:10px;
  	vertical-align: top;
  		  border-collapse:collapse;
  	display: inline-block;
  	background-color: white;
  	width:115px;
  	padding:10px;
  	height:160px;
  }
  .market .recom ul li p{
    margin-top:10px;
    white-space:nowrap;
    text-overflow:ellipsis;
    overflow: hidden;
  	font-size:12px;
  }
  .market .recom ul li span{
  	font-size:15px;
  	color:#ef5737;
  }
  .market .recom ul li i {
  	font-size:12px;
  }
  .market .recom ul li img{
  	width:100%;
  }
  .market .recom ul li >div{
    overflow: hidden;
    height:100px;
  }
  .market .limTime>div {
  	padding:0 10px;
  	margin-bottom:15px;
  }
  .market .limTime>div img{
  	width:15px;
  	vertical-align: middle;
  }
  .market .limTime>div span{
  	height: 16px;
  	line-height: 16px;
  	border-radius: 10px;
  	background-color: #ef5836;
  	display: inline-block;
  	width:22px;
  	text-align: center;
  	color:white;
  }
  .market .like>ul{
  	padding:0 10px;
  	font-size:0;
  }
  .market .like img{
  	width:100%;
    height:100%;
  }
  .market .like header{
    background:url(../../image/cainixihuan.png) no-repeat;
    background-size: cover;
    margin-top:10px;
  }
  .market .like>ul li{
    vertical-align: middle;
  	display: inline-block;
  	width:48%;
  	margin:10px 1% 0;
  	color:#333333;
  	height:250px;
  	background-color: white;
  	box-sizing:border-box;
  	border-collapse: collapse;
  	font-size:13px;
  }
  .market .like>ul li>div{
  	height:145px;
    overflow: hidden;
    padding:10px;
  }
  .market .like>ul li p{
    overflow : hidden;
text-overflow: ellipsis;
display: -webkit-box;
-webkit-line-clamp: 2;
-webkit-box-orient: vertical;
  	font-weight: bold;
  	padding:0 10px;
  	line-height: 20px;
    height:40px;
  }
  .market .like>ul li span{
  	color:#ef5737;
    margin-left:10px;
  	font-size:15px;
  }
  .qidai {
    text-align: center;
  }
  .qidai img{
    width:100%;
  }
  del{
    color:#999;
    font-size:12px;
  }
  [v-cloak]{
    display: none;
  }
  .popup{
    z-index:2001;
    background: rgba(0,0,0,0.5);
    position: fixed;;
    top:0;
    width:100vw;
    display: none;
    height:100vh;
  }
	</style>
</head>
<body>
  <div class="market" v-cloak>
  <div class="banner ">
    <div class="swiper-container">
    <div class="swiper-wrapper">
      <div class="swiper-slide">
          <img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1510742238117&di=fd30037daa4161d250f7591174127565&imgtype=0&src=http%3A%2F%2Fpic2.ooopic.com%2F11%2F86%2F80%2F51bOOOPIC6a_1024.jpg" alt="">
      </div>
      <div class="swiper-slide">
          <img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1510742238117&di=fd30037daa4161d250f7591174127565&imgtype=0&src=http%3A%2F%2Fpic2.ooopic.com%2F11%2F86%2F80%2F51bOOOPIC6a_1024.jpg" alt="">
      </div>
      <div class="swiper-slide">
          <img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1510742238117&di=fd30037daa4161d250f7591174127565&imgtype=0&src=http%3A%2F%2Fpic2.ooopic.com%2F11%2F86%2F80%2F51bOOOPIC6a_1024.jpg" alt="">
      </div>
      </div>
    </div>

  <div class="search">
    <input type="text" placeholder="请输入商品／店铺名">
  </div>
  </div>
  <div class="menu">
    <ul>
    <li @click="all('all')">
      <img src="../../image/Mclassify.png" alt="">
        <p>全部分类</p>
      </li>

      <li @click="all('cart')">
        <img src="../../image/cart.png" alt="">
        <p>购物车</p>
      </li>
      <li @click="all('myorder')">
        <img src="../../image/order.png" alt="">
        <p>我的订单</p>
      </li>
      <li @click="sepcial('specialty')">
        <img src="../../image/techanicon.png" alt="">
        <p>土特产专区</p>
      </li>
      <li @click="all('collection')">
        <img src="../../image/Mshoucang.png" alt="">
        <p>我的收藏</p>
      </li>
      <li @click="all('recommend')">
        <img src="../../image/Mgoods.png" alt="">
        <p>推荐商品</p>
      </li>
      <li @click="foot()" >
        <img src="../../image/Mfoot.png" alt="">
        <p>我的足迹</p>
      </li>
      <li @click="content('限时秒杀')">
        <img src="../../image/Mtime.png" alt="">
        <p>限时秒杀</p>
      </li>

    </ul>
  </div>
  <div class="visit">
    <header><span>逛商场</span></header>
    <ul>
      <li @click="content('食品饮料')">
        <img src="../../image/market/ad1.jpg" alt="">
      </li>
      <li @click="content('厨电特惠')">
        <img src="../../image/market/ad2.jpg" alt="">
      </li>
    </ul>
    <ol>
      <li @click="content('家居家装')">
        <img src="../../image/market/ad3.jpg" alt="">
      </li>
      <li @click="content('美妆特惠')">
        <img src="../../image/market/ad4.jpg" alt="">
      </li>
      <li  @click="content('母婴玩具')">
        <img src="../../image/market/ad5.jpg" alt="">
      </li>
      <li @click="content('智能数码')">
        <img src="../../image/market/ad6.jpg" alt="">
      </li>
    </ol>
  </div>
      <div class="recom">
    <header><span>推荐商品</span></header>
    <ul>
      <li v-for="item in recomGoods" @click="inner(item.id)">
  				<div>
  				<img v-bind:src="url+item.img" alt="" :onerror="errorImg">
  				</div>
  				<p>{{item.name}}</p>
  				<span><i>￥</i>{{item.sell_price}}</span>
  			</li>
    </ul>

  </div>
    <div class="limTime recom">
    <header><span>限时秒杀</span></header>
    <div>
      <p>
        <img src="../../image/littime.png" alt="">
        16点场
        <span>26</span>:<span>00</span>:<span>00</span>
      </p>

    </div>
    <ul>
      <li v-for="item in timeGoods" @click="inner(item.goods_id)" >
    				<div>
    				<img v-bind:src="url+item.img" alt="" :onerror="errorImg">
    				</div>
    				<p>{{item.name}}</p>
    				<span><i>￥</i>{{item.award_value}}</span>
    			</li>
    </ul>

  </div>
    <div class="like">
    <header><span>猜你喜欢</span></header>

    <ul>
      <li v-for="item in likeGoods" @click="inner(item.id)">
  					<div>
  				<img v-bind:src="url+item.img" alt="" :onerror="errorImg">
  				</div>
  				<p>{{item.name}}</p>
  				<span><i>￥</i>{{item.sell_price}}</span>
          <del>{{item.market_price}}</del>
  			</li>

    </ul>

  </div>


</div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="../../script/service.js"></script>
<script type="text/javascript" src="../../script/vue.js"></script>
<script type="text/javascript" src="../../script/swiper-3.4.2.min.js"></script>

<script type="text/javascript">
    apiready = function(){
      // 融云模块
       app=new Vue({
        el: '.market',
        data: {
          url:"https://shop.kuaiyunma.com/",
          timeGoods:[],
          recomGoods:[],
          likeGoods:[],
          page:1,
          errorImg: 'this.src="../../image/default.png"'

        },
        created:function(){
          var that = this
          this.init()
          that.$nextTick(function(){
            var mySwiper = new Swiper ('.swiper-container', {
                direction: 'horizontal',
                loop: true,
                autoplay: 2000
                // 如果需要分页器


              })
          })
          api.setCustomRefreshHeaderInfo({
          bgColor: '#eee',
          images: [
              'widget://image/refresh/dropdown0.png',
              'widget://image/refresh/dropdown1.png',
              'widget://image/refresh/dropdown2.png',
              'widget://image/refresh/dropdown3.png',
              'widget://image/refresh/dropdown4.png',
              'widget://image/refresh/dropdown5.png',
              'widget://image/refresh/dropdown6.png'
          ],
          tips: {
              pull: '下拉刷新',
              threshold: '松开立即刷新',
              load: '正在刷新'
          }
      }, function() {
          //下拉刷新被触发，自动进入加载状态，使用 api.refreshHeaderLoadDone() 手动结束加载中状态
          //下拉刷新被触发，使用 api.refreshHeaderLoadDone() 结束加载中状态
            that.init()


      });
          api.addEventListener({
            name: 'scrolltobottom'
          }, function(ret, err){

            that.loadmore()

            });
        },
      methods:{
        foot(){
          api.openWin({
              name: 'myfootWin',
              url: '../../html/market/myfootWin.html'
          });

        },
        all(name){
          api.openWin({
              name: name,
              url: '../../html/market/'+name+'Win.html',
              bounces:false

          });

        },

        loadmore(){
          var that = this
          that.page++
          api.showProgress({
              style: 'default',
              title: '努力加载中...',
              text: '先喝杯茶...',
              modal: false
          });
          getData('/shop/goods/promotions/commend_goods',function(data){
            if(data.code==200){
              data.data.forEach(function(item){
                that.likeGoods.push(item)
              })
              api.hideProgress();
            }
          },{'commend_id':4,'page':that.page,'page_size':6},{'Authorization':$api.getStorage('token')})

        },
          init(){
            var that =this
            that.timeGoods=[],
            that.recomGoods=[],
            that.likeGoods=[]
            that.page=1;
            api.showProgress({
                style: 'default',
                title: '努力加载中...',
                text: '先喝杯茶...',
                modal: false
            });

            getData('/shop/goods/promotions/flash_sale',function(data){
              if(data.code==200){
                that.timeGoods=data.data
              }
            },{},{'Authorization':$api.getStorage('token')})
            getData('/shop/goods/promotions/commend_goods?commend_id=4&page=1&page_size=6',function(data){
              if(data.code==200){
                that.recomGoods=data.data
                that.likeGoods=data.data
                api.refreshHeaderLoadDone()

                api.hideProgress();

              }
            },{},{'Authorization':$api.getStorage('token')})
          },
          sepcial(){
            api.openWin({
                name: 'specialtyWin',
                url: '../../html/market/specialtyWin.html'

            });
          },
          inner(id){
            api.openWin({
                name: 'goodsInner',
                url: '../../html/market/goodsInnerWin.html',
                pageParam: {
                    id: id
                }
            });

          },
          content(name){
            api.openWin({
                name: 'Mcontent',
                url: '../../html/market/contentWin.html',
                pageParam: {
                    name: name
                }
            });

          }


      }
      })


}

</script>
</html>
